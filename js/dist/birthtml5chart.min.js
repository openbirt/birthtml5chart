/*! birthtml5chart 14-09-2014 */
!function(){function a(a){return"number"==typeof a}function b(a){return"stirng"==typeof a}function c(a){return"funciton"==typeof a}function d(a){return"object"==typeof a}function e(a){if(!a)return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function f(a){return a*Math.PI/180}function g(a){return 180*a/Math.PI}function h(){var a=document.createElement("div");a.setAttribute("id","testdiv"),a.style.height="1in",a.style.left="-100%",a.style.position="absolute",a.style.top="-100%",a.style.width="1in";var b=document.getElementsByTagName("body")[0];b.appendChild(a);var c=document.getElementById("testdiv").offsetWidth;return b.removeChild(a),c}function i(a,b,c){if(!b)return a;var d=K?K:K=h(),e=parseFloat(a),f=e,g=a.indexOf("pt")>0?"pt":a.indexOf("in")>0?"in":a.indexOf("mm")>0?"mm":a.indexOf("cm")>0?"cm":"px",i=null;return"pt"===g?f=d*e/72:"in"===g?f=e*d:"mm"===g?f=d*e/25.4:"cm"===g&&(f=d*e/2.54),"pt"===b?(f=72*f/d,i="pt"):"in"===b?(f/=d,i="in"):"mm"===b?(f=25.4*f/d,i="mm"):"cm"===b?(f=2.54*f/d,i="cm"):"px"===b&&(f=f,i="px"),c===!0?f:f+i}function j(a,b){return i(a,"px",b)}function k(a){if(null===a||"object"!=typeof a)return a;var b=new a.constructor;for(var c in a)a.hasOwnProperty(c)&&(b[c]=k(a[c]));return b}function l(a){if(null===a||"object"!=typeof a)return a;var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=l(a[c]));return b}function m(a,b){if(!b)return a;if(!a)return k(b);for(var c in b)b.hasOwnProperty(c)&&(a[c]=null===b[c]||"object"!=typeof b[c]?b[c]:m(a[c],b[c]));return a}function n(a,b){var c=null;a||(a={});for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function o(a,b,c,d){function e(){return this.fInit&&this.fInit.apply(this,arguments),this}var f=b?b:e;return f.prototype=c?new c:{},n(f.prototype,d),f.prototype.__super=c?c.prototype:null,f.prototype.__className=a,f}function p(a,b,c){var d=b,e=c,f=!0;"object"!=typeof b||e||(d=b.degree,e=b.mode,f=b.enabled!==!1);var g,h,i,j,k,l;return f&&"number"==typeof d&&(g=a.getBBox(),"auto"===e?k="":(h="start"===e?g.x:"end"===e?g.x+g.width:g.x+g.width/2,i=g.y+g.height/2,k=" "+h+" "+i),l="rotate("+d+k+")",j=a.getAttribute("transform"),j?j.match(L)?j=j.replace(L,l):j+=" "+l:j=l,a.setAttribute("transform",j)),a}function q(a,b,c){var d=b,e=c,f=!0;return"object"!=typeof b||e||(d=b.degree,e=b.mode,f=b.enabled!==!1),a.attr("transform",function(){var a,b,c,g,h,i=null;return f&&"number"==typeof d&&(a=this.getBBox(),"auto"===e?g="":(b="start"===e?a.x:"end"===e?a.x+a.width:a.x+a.width/2,c=a.y+a.height/2,g=" "+b+","+c),h="rotate("+d+g+")",i=this.getAttribute("transform"),i?i.match(L)?i=i.replace(L,h):i+=" "+h:i=h),i})}function r(a,b,c,d){function e(a,b,c){return"function"==typeof a?a(b,c,d):a}if(1===arguments.length){var f=[];return a.each(function(){var a,b,c=this.getAttribute("transform");c&&c.indexOf("translate")>=0&&(c=c.match(M),c&&c.length&&(c=c[0].match(/([0-9\.\-]+)/g),c&&c.length&&(a=parseFloat(c[0]),b=c[1]?parseFloat(c[1]):0,f.push({x:a,y:b}))))}),f}return a.attr("transform",function(a,d){var f="translate("+e(b,a,d)+","+e(c,a,d)+")",g=this.getAttribute("transform");return g?g.match(M)?g=g.replace(M,f):g+=" "+f:g=f,g})}function s(a){return a instanceof Array?a:[a]}function t(a){return"."+a.replace(" ",".")}function u(a){if("function"==typeof a)return a;if("object"==typeof a){for(var b in a)if(a.hasOwnProperty(b)){var c=u(b);c!==b&&(a[c]=a[b],a[b]=null,delete a[b])}return a}return a?a.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}):{}}function v(a,b){b.x&&a.attr("x",b.x),b.y&&a.attr("y",b.y),b.dx&&a.attr("dx",b.dx),b.dy&&a.attr("dy",b.dy),b.width&&a.attr("width",b.width),b.heigth&&a.attr("height",b.height)}function w(a,b){var c,d=typeof b;return"string"===d||"function"===d?(c={},c[a]=b,c):"object"===d?u(b):{}}function x(a){return a?a.strokeWidth||a["stroke-width"]||a.width||0:0}function y(a,b){if("object"==typeof a)for(var c in a)a.hasOwnProperty(c)&&("roundCorner"===c?(a.rx=a.rx||a.roundCorner,a.ry=a.ry||a.roundCorner):"dashStyle"===c?a[c]=C.call(this,c,a[c],x(a),b):("stroke"===c||"fill"===c)&&(a[c]=z.call(this,a[c],b)));return w.call(this,"border",a)}function z(a,b){var c=null,d=null,e=null,f=null,g=0;if("function"==typeof a)return function(c){var d=b?d3.merge(arguments,[b]):arguments;return a.apply(c,d)};if("object"!=typeof a)return a;if("image"===a.type)return c=this.getBBox(),d=this.d3Sel.append("image").datum(a),d.attr({x:0,y:0,width:c.width,height:c.height,"xlink:href":a.parameters&&a.parameters[0]}),a.indexOf("url")>=0?a:"#url("+a+")";if("linearGradient"===a.type||"radialGradient"===a.type){var h=b.fDefs();for(e=A(a.type),f=h.append(a.type).attr("id",e).attr(B(a)),g=0;g<a.stops.length;g++)f.append("stop").attr(u({offset:a.stops[g].offset||"0%",stopColor:a.stops[g].stopColor||this.options&&this.options.fill||"white",stopOpacity:a.stops[g].stopOpacity||1}));return"url(#"+e+")"}}function A(a){return GLOBAL.prefix+"-"+(a?a+"-":"")+O++ +"-"+Math.random().toString(2).slice(2)}function B(a){var b=a.parameters,c=null;return"linearGradient"===a.type?(b=b||["0%","0%","100%","100%"],"string"==typeof b&&(c=b.split(","),b=[],b[0]=N[c[0]][0],b[1]=N[c[0]][1],b[2]=N[c[1]][0],b[3]=N[c[1]][1]),{x1:b[0],y1:b[1],x2:b[2],y2:b[3]}):"radialGradient"===a.type?{cx:b[0],cy:b[1],r:b[2],fx:b[3],fy:b[4]}:void 0}function C(a,b,c){var d,e=a;if("function"==typeof e)return function(){var a=c?d3.merge(arguments,[c]):arguments;return e.apply(this,a)};if(e=e&&e.toLowerCase(),"solid"===e)e="none";else if(e){for(e=e.replace(/(shortdashdotdot)/g,"3,1,1,1,1,1,").replace(/(shortdashdot)/g,"3,1,1,1").replace(/(shortdot)/g,"1,1,").replace(/(shortdash)/g,"3,1,").replace(/(longdash)/g,"8,3,").replace(/(dot)/g,"1,3,").replace(/(dash)/g,"4,3,").replace(/,$/,"").split(","),d=e.length;d--;)e[d]=parseInt(e[d])*b;e=e.join(",")}return e}function D(a,b){if("object"==typeof a)for(var c in a)a.hasOwnProperty(c)&&("stroke"===c||"fill"===c)&&(a[c]=z.call(this,a[c],b),a[c+"Opacity"]=void 0===a[c+"Opacity"]?1:a[c+"Opacity"]);return w.call(this,"font",a)}function E(a){return w.call(this,"fill",a)}function F(a){if("string"==typeof a){var b=a.split(/ /g);switch(b.length){case 1:return{top:j(b[0],!0),right:j(b[0],!0),bottom:j(b[0],!0),left:j(b[0],!0)};case 2:return{top:j(b[0],!0),right:j(b[1],!0),bottom:j(b[0],!0),left:j(b[1],!0)};case 3:return{top:j(b[0],!0),right:j(b[1],!0),bottom:j(b[2],!0),left:j(b[1],!0)};case 4:return{top:j(b[0],!0),right:j(b[1],!0),bottom:j(b[2],!0),left:j(b[3],!0)}}return{top:0,right:0,bottom:0,left:0}}var c=m({top:0,right:0,bottom:0,left:0},a);return c}function G(a){return F(a)}function H(){return{x:0,y:0,width:0,height:0}}function I(a,b){var c=typeof b;return b?"function"===c?b.call(this,a):"string"===c?d3.format(b).call(this,a):void 0:a}function J(a){return"center"===a?"middle":"right"===a?"end":"start"}d3.selection.prototype.bbox=function(a){if(!a&&this._bbox)return this._bbox;this._bbox={x:0,y:0,width:0,height:0};for(var b=0,c=this.length;c>b;b++)for(var d=this[b],e=0,f=d.length;f>e;e++){var g=d[e];if(g&&("g"===g.nodeName||"text"===g.nodeName)){var h=g._bbox;(!h||a)&&(h=h||g.getBBox()),this._bbox.x=h.x<this._bbox.x?h.x:this._bbox.x,this._bbox.y=h.y<this._bbox.y?h.y:this._bbox.y,this._bbox.width=h.x+h.width>this._bbox.x+this._bbox.width?h.width:this._bbox.width,this._bbox.height=h.y+h.height>this._bbox.y+this._bbox.height?h.height:this._bbox.height}}return this._bbox},d3.transition.prototype.bbox=d3.selection.prototype.bbox,d3.selection.prototype.opts=function(){return arguments.length?this.property("__opts__",value):this.property("__opts__")};var K,L=/rotate\(.*?\)/g,M=/translate\(.*?\)/g,N={L:["0%","50%"],R:["100%","50%"],T:["50%","0%"],B:["50%","100%"],LT:["0%","0%"],TL:["0%","0%"],LB:["0%","100%"],BL:["0%","100%"],RT:["100%","0%"],TR:["100%","0%"],RB:["100%","100%"],BR:["100%","100%"]},O=0,P={lazyRender:!0,prefix:"d3charts"},Q=function(){},R=function(){},S=o("Context",null,Object,{prefix:null,lazyRender:null,svgNode:null,fInit:function(a){this.prefix=P.prefix,this.lazyRender=P.lazyRender,this.svgNode=a},fSvgNode:function(){return arguments.length?(this.svgNode=arugments[0],this):this.svgNode},fDefs:function(){return arguments.length?(this.defs=arguments[0],this):this.defs?this.defs:this.defs=d3.select(this.svgNode).append("defs")}}),T=o("RenderCallback",null,null,{fBeforeRendering:function(){},fAfterRendering:function(){}}),Q=o("Element",null,T,{__className:null,__super:null,context:null,parent:null,options:null,d3Sel:null,isRendered:!1,fInit:function(a,b,c){this.context=a,this.parent=b,this.options=c||{}},fOptions:function(){return arguments.length?(this.options=arguments[0],this.fApplyChange(this.fOptions)):this.options},fApplyChange:function(){return this.context.lazyRender||this.fRedraw(),this},fRender:function(a){return this.d3Sel=a,this.fBeforeRendering.apply(this,arguments),this._fRender.apply(this,arguments),this.isRendered=!0,this.fAfterRendering.apply(this,arguments),this},_fRender:function(){return this},fRedraw:function(){return this.d3Sel&&this.fDestory()&&this.fRender(this.d3Sel),this},fAttr:function(){var a=null;if(this.d3Sel)if(1===arguments.length){if(a=typeof arguments[0],"string"===a)return this.d3Sel.attr(arguments[0]);"object"===a&&this.d3Sel.attr.apply(this,arguments)}else arguments.length&&this.d3Sel.attr.apply(this,arguments);return this},fClassNames:function(){return this.options.id?this.options.id+" "+this.__className:this.__className},fBBox:function(){return this.d3Sel?l(this.d3Sel.bbox()):{}},fDestory:function(){return this.d3Sel?(this.d3Sel.selectAll("*").remove(),this.isRendered=!1,!0):!1}}),U=o("Text",null,Q,{_fRender:function(a){var b=this.options,c=this.fClassNames(),d=a.selectAll(t(c)).data(s(b.data));d.exit().remove(),d.enter().append("text").attr("class",c),d.each(function(a){var c=d3.select(this),d=a.split("\n");if(d.length<=1)c.text(function(a){return I(a,b.format)});else for(var e in d)c.append("tspan").text(function(){return I(d[e],b.format)}).attr("x",b.x||0).attr("dy",1*e+"em")}).style(D(b.font)).style(y(b.border)).style(E(b.color)).call(function(a,b){var c=a.bbox().height,d=b.verticalAlign&&"top"!==b.verticalAlign?"center"===b.verticalAlign?c/2:0:c;if("function"==typeof b.y){var e=b.y;b.y=function(){return e.apply(this,arguments)+d}}else b.y=(b.y||0)+d;a.call(v,b)},b).style("text-anchor",J(b.align)).call(q,b.rotate)}}),R=o("Label",null,Q,{_fRender:function(a){var b=this.options,c=null,d=x(b.border),f=this.fClassNames(),g=a.selectAll(t(f)).data(s(b.data));b.margin=F(b.margin),b.padding=G(b.padding),g.exit().remove(),g.enter().append("g").attr("class",f),g.call(r,b.x||0,b.y||0,this.context).each(function(){var a=d3.select(this),f=a.append("rect").attr("class","outline").attr({x:0,y:0});e(b.border)&&e(b.background)||(c=a.append("rect").attr("class","border background").attr(y(b.border)).attr(E(b.background))),textSel=a.append("text").attr("class","text").each(function(a){var c=d3.select(this),d=a.split("\n");if(d.length<=1)c.text(function(a){return I(a,b.format)});else for(var e in d)c.append("tspan").text(function(){return I(d[e],b.format)}).attr("x",b.x||0).attr("dy",1*e+"em")}).style(D(b.font)).style(y(b.fontBorder)).style(E(b.fontColor)).style("text-anchor",J(b.align));var g=f.bbox(),h=c?c.bbox():H(),i=textSel.bbox();h.x=b.margin.left,h.y=b.margin.top,i.x=h.x+d+b.padding.left,i.y=h.y+d+b.padding.top,h.width=2*(i.x-h.x)+i.width,h.height=2*(i.y-h.y)+i.height,g.width=b.margin.left+h.width+b.margin.right,g.height=b.margin.top+h.height+b.margin.bottom,f.attr({x:g.x,y:g.y,width:g.width,height:g.height}),c&&c.attr({x:h.x,y:h.y,width:h.width,height:h.height}),textSel.attr({x:i.x,y:i.y+i.height/(textSel.selectAll("tspan").size()||1)}),textSel.selectAll("tspan").attr("x",textSel.attr("x"));var j="right"===b.align?-g.width:"center"===b.align?-g.width/2:0,k="bottom"===b.verticalAlign?-g.height:"center"===b.verticalAlign?-g.height/2:0,l=r(a);a.call(r,l[0].x+j,l[0].y+k,this.context).call(q,b.rotate)})}}),V=V||{};V.Global=P,V.Context=S,V.Text=U,V.Label=R;var W=W||{};V.util=W,W.DPI=K,W.getDPI=h,W.uniqueId=A,W.clone=k,W.copy=l,W.merge=m,W.isFunction=c,W.isNumber=a,W.isObject=d,W.isString=b,W.emptyObject=e,W.toRadian=f,W.toDegree=g,W.toArray=s,W.rotateNode=p,W.adaptSize=i,window.birtchart=window.birtchart||V}();