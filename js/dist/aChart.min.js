/*! birthtml5chart 08-09-2014 */
!function(){function a(b){if("object"==typeof b){for(var c in b)if(b.hasOwnProperty(c)){var d=a(c);d!==c&&(b[d]=b[c],b[c]=null,delete b[c])}return b}return b?b.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}):b}function b(a,b){var c=typeof a;return"string"===c&&a.indexOf("%")>=0?parseInt(a)*b/100:a}function c(){return this.init.apply(this,arguments)}function d(){return this.init.apply(this,arguments)}{var e=2*Math.PI,f=d3.format("f0"),g=d3.format(".00%"),h=750,i="cubic-in-out";({width:600,height:600,duration:250,series:[{name:null,background:"#ddd",backgroundOpacity:1,innerRadius:"30%",outerRadius:"60%",colors:d3.scale.category20().range(),data:[30,50,60,20],maxValue:200,categories:["China","USA","Japan","UK"],label:{enabled:!0,format:function(){return function(a){return a.category+","+j.format.formatPercent(a.percentValue)}},fill:"#0f0",font:{"font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',"font-size":"24px","font-weight":"bold"}},animation:{enabled:!0,duration:500,ease:"cubic-in-out"},sliceStyle:{stroke:"",strokeWidth:"",strokeOpacity:"",fill:"",fillOpacity:""}},{name:null,background:"#ddd",innerRadius:"70%",outerRadius:"90%",colors:d3.scale.category20c().range(),data:[70,90,160,200],categories:["Shanghai","Beijin","Hangzhou","Nanjing"],label:{enabled:!1,format:function(){return function(a){return a.category+","+j.format.formatPercent(a.percentValue)}},fill:"#0f0",font:{"font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',"font-size":"24px","font-weight":"bold"}}}],categories:[],text:{enabled:!0,background:"",fill:"#f00",font:{"font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',"font-size":"24px","font-weight":"bold"},format:function(a,b){return function(a){var c=b||a;return j.format.formatInt(c.value*(c.currAngle-c.startAngle)/(c.endAngle-c.startAngle))}}},animation:{enabled:!0,duration:500,ease:"linear"},on:{end:null}})}c.prototype={svg:null,init:function(a){return this.opts=a,this.svg=null,this},render:function(a){var b,c,d=this.opts;void 0===d.width&&(d.width=$(a).width()),void 0===d.height&&(d.height=$(a).height()),this.svg=d3.select(a).append("svg"),b=this.svg.attr("width",d.width).attr("height",d.height).append("g").attr("class","chartArea").attr("transform","translate("+d.width/2+","+d.height/2+")"),b=b.append("g").attr("class","donutPlot"),d.text&&d.text.enabled&&(c=b.append("text").attr("text-anchor","middle").attr("dy",".35em").style("fill",d.text.fill).style(d.text.font));var e={};return e.transitionCount=0,e._this=this,e.opts=d,e.seriesIndex=0,e.donutPlot=b,e.text=c,this.onRenderSeries(e),this},onRenderSeries:function(a){a.seriesCallback=this.renderSeries,this.renderSeries(a)},renderSeries:function(b){var c,d,f,g=b.seriesIndex,h=b.opts.series[g],i=b.donutPlot,j=i.append("g").attr("class","series donutSeries "+(h.name||g)),k=h.maxValue?h.maxValue:d3.max([this.getTotal(h.data),h.maxValue||0]),l=0,m=d3.min([b.opts.width,b.opts.height]);for(j.datum(h),h.innerRadius&&"string"==typeof h.innerRadius&&h.innerRadius.indexOf("%")>=0&&(h.innerRadius=m*parseFloat(h.innerRadius)/200),h.outerRadius?h.outerRadius&&"string"==typeof h.outerRadius&&h.outerRadius.indexOf("%")>=0&&(h.outerRadius=m*parseFloat(h.outerRadius)/200):h.outerRadius=m/2,h.animation=$.extend({},b.opts.animation||{},h.animation||{}),f=0;f<h.data.length;f++)d={},d.value=h.data[f],d.percentValue=h.data[f]/k,d.startAngle=l,d.endAngle=l+d.percentValue*e,d.category=h.categories&&h.categories[f]||opts.categories&&opts.categories[f],d.style=$.extend({},a(h.sliceStyle)),d.style.fill=d.style.fill||(h.colors||d3.scale.category20())[f%20],l=d.endAngle,h.data[f]=d;c=d3.svg.arc().startAngle(0).innerRadius(h.innerRadius).outerRadius(h.outerRadius),j.append("path").attr("class","background").attr("d",c.endAngle(e)),h.background&&j.style("fill",h.background),h.backgroundOpacity&&j.style("fill-opacity",h.backgroundOpacity),b.donutSeries=j,this.onRenderSlice(b)},onRenderSlice:function(a){a.seriesData=a.opts.series[a.seriesIndex].data.concat([]),a.sliceIndex=0,a.sliceCallback=this.sliceCallback,this.renderSlice(a)},renderSlice:function(a){var b=this;sliceIndex=a.sliceIndex,seriesData=a.seriesData,data=a.seriesData[sliceIndex],seriesOpts=a.opts.series[a.seriesIndex],animation=seriesOpts.animation,donutSeries=a.donutSeries,text=a.text,arc=d3.svg.arc().startAngle(data.startAngle).endAngle(data.startAngle).innerRadius(seriesOpts.innerRadius).outerRadius(seriesOpts.outerRadius),a.arc=arc,donutSeries.append("path").datum(data).attr("class","slice "+sliceIndex).style(data.style).attr("d",arc).transition().ease(animation.enabled?animation.ease||i:i).duration(animation.enabled?animation.duration||h:0).call(this.arcTween,a).each("start",function(){a.transitionCount++}).each("end",function(){var c;seriesOpts.label&&seriesOpts.label.enabled&&(c=donutSeries.append("text").attr("class","sliceLabel "+sliceIndex).datum(data).attr("dy",".35em").style("text-anchor","middle").style("fill",seriesOpts.label.fill).style(seriesOpts.label.font).text(seriesOpts.label.format(a)).attr("transform","translate(0, 0)").transition().ease(animation.enabled?animation.ease||i:i).duration(animation.enabled?animation.duration||h:0).attr("transform",function(a){return"translate("+arc.centroid(a)+")"}).each("start",function(){a.transitionCount++}).each("end",function(){0===--a.transitionCount&&a.opts.on&&a.opts.on.end&&a.opts.on.end.call(a._this,a)})),0===--a.transitionCount&&a.opts.on&&a.opts.on.end&&a.opts.on.end.call(a._this,a),a.sliceCallback.call(b,a)})},sliceCallback:function(a){var b=a.sliceIndex,c=a.seriesIndex,d=a.opts.series[c];b+1<d.data.length?(a.sliceIndex++,this.renderSlice(a)):a.seriesIndex+1<a.opts.series.length&&(a.seriesIndex++,a.seriesCallback.call(this,a))},arcTween:function(a,b){var c=b.arc,d=b.text;a.attrTween("d",function(a){var e=d3.interpolate(a.startAngle,a.endAngle);return function(f){var g=e(f);if(d){var f=$.extend({},a);f.currAngle=g,d.datum(f),d.text(b.opts.text.format(b,f))}return c.endAngle(g),c()}})},getTotal:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b}};({mode:"horizontal",width:600,height:400,padding:{top:20,right:20,bottom:20,left:20},fillStyle:{fill:"#FFFFCC",fillOpacity:1,stroke:"black",strokeWidth:1,strokeOpacity:.5},animation:{enabled:!0,mode:"oneByOne",ease:null,duration:1e3},plot:{fill:"#FFFF99",fillOpacity:1,stroke:"red",strokeWidth:1,strokeOpacity:.5},xAxis:{type:null,line:{fill:"none",stroke:"green",strokeWidth:1,strokeOpacity:.5},tick:{number:10,fillStyle:{stroke:"green",strokeWidth:2,strokeOpacity:.5}},label:{enabled:!0,fillStyle:{fill:""},fontStyle:{},format:null}},yAxis:{type:null,line:{stroke:"black",strokeWidth:1,strokeOpacity:.5},tick:{number:10,fillStyle:{stroke:"black",strokeWidth:1,strokeOpacity:.5}},label:{enabled:!0,fillStyle:{fill:""},fontStyle:{},format:null}},series:[{enabled:!0,data:[100,200,150,170],label:{enabled:!0,fontStyle:{"font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',"font-size":"24px","font-weight":"bold"},animation:{enabled:!0,mode:"oneByOne",ease:null,duration:1e3}},colors:d3.scale.category20().range(),fillStyle:{fill:"#CCCCCC",fillOpacity:1,stroke:"#999999",strokeWidth:2,strokeOpacity:.5},width:"50%"},{enabled:!0,data:[80,100,110,90],label:{enabled:!0,format:function(a){return a.value},fontStyle:{"font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',"font-size":"24px","font-weight":"bold"}},colors:d3.scale.category20().range(),width:"50%"}],categories:{type:null,data:["a","b","c","d"]},on:{end:null}});d.prototype={opts:null,init:function(a){this.opts=a},render:function(b){var c,d,e=this.opts,f={},g={};f.barChart=this,f.opts=e,f.remainedBox=g,f.isVertical="vertical"===e.mode,e.width||(e.width=$(b).width()),e.height||(e.height=$(b).height()),g.x=0,g.y=0,g.w=e.width,g.h=e.height,this.svg=d3.select(b).append("svg"),c=this.svg.attr("width",e.width).attr("height",e.height).append("g").attr("class","chart barChart"),d=c.append("g").attr("class","chartArea"),e.padding&&(g.x+=e.padding.left||0,g.y+=e.padding.top||0,g.w-=(e.padding.left||0)+(e.padding.right||0),g.h-=(e.padding.top||0)+(e.padding.bottom||0)),this.adaptSeries(f),this.adaptAxis(f);var h=d3.scale.linear().range(f.isVertical?[g.h,0]:[0,g.w]).domain([0,f.seriesValueExtent[1]]),i=d3.svg.axis().scale(h).orient(f.isVertical?"left":"bottom").ticks(e.yAxis.tick.number||10);e.yAxis.label.format&&i.tickFormat(e.yAxis.label.format);var j=d.append("g").attr("class","yAxis").attr("transform","translate("+g.x+","+g.y+")").call(i);j.selectAll("text").style(a(e.yAxis.label.fillStyle)),j.select("path").style(a(e.yAxis.line)),j.selectAll("line").style(a(e.yAxis.tick.fillStyle));var k=j.node().getBBox(),l=d3.scale.ordinal().rangeBands(f.isVertical?[0,g.w]:[g.h,0]).domain(e.categories.data),m=d3.svg.axis().scale(l).orient(f.isVertical?"bottom":"left");e.xAxis.label.format&&m.tickFormat(e.xAxis.label.format);var n=d.append("g").attr("class","xAxis").attr("transform","translate(0,"+(g.y+g.h)+")").call(m);n.selectAll("text").style(a(e.xAxis.label.fillStyle)),n.select("path").style(a(e.xAxis.line)),n.selectAll("line").style(a(e.xAxis.tick.fillStyle));var o=n.node().getBBox(),p=n.select(".tick").node().getBBox(),q=j.select(".tick").node().getBBox();f.isVertical?(l.rangeBands([0,g.w-q.width]),m.scale(l),n.attr("transform","translate("+(g.x+k.width)+", "+(g.y+g.h-o.height)+")").call(m),h.range([g.h-p.height,0]),i.scale(h),j.attr("transform","translate("+(g.x+k.width)+","+g.y+")").call(i)):(h.range([0,g.w-o.width]),i.scale(h),j.attr("transform","translate("+(g.x+o.width)+","+(g.y+g.h-k.height)+")").call(i),l.rangeBands([g.h-k.height,0]),m.scale(l),n.attr("transform","translate("+(g.x+o.width)+", "+g.y+")").call(m)),f.isVertical?(f.remainedBox.x+=k.width,f.remainedBox.w-=k.width,f.remainedBox.h-=o.height):(f.remainedBox.x+=o.width,f.remainedBox.w-=o.width,f.remainedBox.h-=k.height),chartPlot=d.append("g").attr("class","plot").style(a(e.plot.fillStyle)).attr("transform","translate("+g.x+","+g.y+")"),f.transitionCount=0,f.x=l,f.y=h,f.xAxis=m,f.yAxis=i,f.barChart=c,f.chartArea=d,f.chartPlot=chartPlot,f.xAxisBlock=n,f.yAxisBlock=j,f.renderSeriesCallback=this.renderSeries,f._this=this,this.onRenderSeries(f)},onRenderSeries:function(a){var b=a.opts;if("oneByOne"===b.animation.mode)series=b.series[0],a.seriesIndex=0,a.renderSeriesCallback.call(a._this,series,a);else for(var c=0;c<b.series.length;c++)series=b.series[c],a.seriesIndex=c,a.renderSeriesCallback.call(a._this,series,a)},renderSeries:function(c,d){var e,f,g,j,k,l=d.x,m=d.y,n=d.remainedBox,o=d.x.rangeBand();c.enabled!==!1&&(k=b(c.width||o,o),e=chartPlot.append("g").attr("class","series "+d.seriesIndex),f=e.selectAll(".bar").data(c.data).enter(),g=f.append("rect").attr("class","bar").each(function(b){d3.select(this).style(a(b.fillStyle))}).attr("x",function(a){return d.isVertical?l(a.category)+(o-k)/2:0}).attr("width",d.isVertical?b(c.width||o,o):0).attr("y",d.isVertical?n.h:function(a){return l(a.category)+(o-k)/2}).attr("height",d.isVertical?0:k).transition().duration(c.animation.enabled!==!1?c.animation.duration||h:h).ease(c.animation.enabled!==!1?c.animation.ease||i:i).attr("y",d.isVertical?function(a){return m(a.value)}:function(a){return l(a.category)+(o-k)/2}).attr("width",d.isVertical?b(c.width||o,o):function(a){return m(a.value)}).attr("height",d.isVertical?function(a){return n.h-m(a.value)}:k).each("start",function(){d.transitionCount++}).each("end",function(a,b){b+1<=c.data.length&&d.opts.animation.enabled!==!1&&"oneByOne"===d.opts.animation.mode&&(d.seriesIndex++,d.seriesIndex<d.opts.series.length&&d.renderSeriesCallback.call(d._this,d.opts.series[d.seriesIndex],d)),0===--d.transitionCount&&d.opts.on&&d.opts.on.end&&d.opts.on.end.call(d._this,d)}),c.label.enabled!==!1&&(j=f.append("text").attr("class","label").text(function(a){return a.label.format!==!1?a.label.format?a.label.format.call(this,a,d):a.value:""}).each(function(b){var c=d3.select(this);c.style(a(b.label.fillStyle)).style(a(b.label.fontStyle)).attr("text-anchor",b.label.align).attr("x",d.isVertical?l(b.category)+o/2:0).attr("y",d.isVertical?d.remainedBox.h:l(b.category)+o/2).transition().duration(b.label.animation.enabled!==!1?b.label.animation.duration||h:h).ease(b.label.animation.enabled!==!1?b.label.animation.ease||i:i).attr("x",d.isVertical?l(b.category)+o/2:m(b.value)).attr("y",d.isVertical?m(b.value):l(b.category)+o/2).attr("dy",d.isVertical?"0em":".5em").each("start",function(){d.transitionCount++}).each("end",function(){0===--d.transitionCount&&d.opts.on&&d.opts.on.end&&d.opts.on.end.call(d._this,d)})})))},adaptAxis:function(a){var b=a.opts,c=b.xAxis,d=b.yAxis;c.line=c.line||{},c.line.fill=c.line.fill||"none",d.line=d.line||{},d.line.fill=d.line.fill||"none"},adaptSeries:function(a){var b,c,d,e,f,g,h=a.opts.series,i=[0,0],j=a.opts.categories.data;for(b=0;b<h.length;b++)for(f=h[b],f.label.align=f.label.align||(a.isVertical?"middle":"end"),f.animation=$.extend({},a.opts.animation||{},f.animation||{}),c=0;c<f.data.length;c++)d=f.data[c],g=typeof d,"object"!==g?(e={},e.value=d):e=f.data[c],e.category=j[c],e.fillStyle=$.extend({},f.fillStyle,e.fillStyle),e.fillStyle.fill=e.fillStyle.fill||(f.colors||d3.scale.category20().range())[c%f.data.length],e.label=$.extend({},f.label),e.label.animation=$.extend({},f.animation,e.label.animation),f.data[c]=e,i=d3.extent(i.concat(d3.extent([e.value])));a.seriesValueExtent=i}};var j=window.aCharts||{};j.format={},j.format.formatInt=f,j.format.formatPercent=g,j.TWO_PI=e,j.DEFAULT_DURATION=h,j.DEFAULT_EASE=i,j.util=j.util||{},j.util.toCssStyle=a,j.util.adaptSize=b,j.Bar=d,j.Donut=c,window.aCharts=window.aCharts||j}();